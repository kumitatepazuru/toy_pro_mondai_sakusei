$(function(){function f(){let i=$("#random-case-list-row");i.empty();$("#random_case-list").empty();t=[];n.forEach(function(n){i.append('<th class="mdc-data-table__header-cell">変数'+n[0]+"<\/th>")});i.append('<th class="mdc-data-table__header-cell">対応する文字列<\/th>');i.append('<th class="mdc-data-table__header-cell">コーナーケース<\/th>');i.append('<th class="mdc-data-table__header-cell"><\/th>');i.append('<th class="mdc-data-table__header-cell"><\/th>')}const e=new mdc.dialog.MDCDialog(document.querySelector(".welcome")),o=new mdc.dialog.MDCDialog(document.querySelector(".license")),i=new mdc.dialog.MDCDialog(document.querySelector(".change-table-data")),r=new mdc.dialog.MDCDialog(document.querySelector(".case")),u=new mdc.menu.MDCMenu(document.querySelector(".mdc-menu")),s=new mdc.dialog.MDCDialog(document.querySelector("#error-dialog")),h=new mdc.dialog.MDCDialog(document.querySelector("#success"));u.listen("MDCMenu:selected",function(n){$("#hname").text($("#h"+n.detail.index+" > .mdc-list-item__text").text())});const n=[["A","int"],["B","int"]];let t=[[2,3,8,!1],[3,2,9,!1],[1,1,1,!0]];document.querySelectorAll(".mdc-text-field").forEach(function(n){new mdc.textField.MDCTextField(n)});document.querySelectorAll(".mdc-button").forEach(function(n){new mdc.ripple.MDCRipple(n)});document.querySelectorAll(".mdc-checkbox").forEach(function(n){new mdc.checkbox.MDCCheckbox(n)});e.open();i.escapeKeyAction="";i.scrimClickAction="";r.escapeKeyAction="";r.scrimClickAction="";$("#show-license").on("click",function(){o.open()});$("#sentaku-kata").on("click",function(){u.open=!0});$("#save").on("click",function(){const t=$("#name").val();if(t!==""){const r=$("#hid").text(),u=$("#hname").text();n[r][0]=t;n[r][1]=u;i.close();$("#hensuu-"+r+" > .name").text(t);$("#hensuu-"+r+" > .hname").text(u);f()}else $("#error-hensuu-name").removeClass("d-none")});$("#add_hensuu").on("click",function(){$("#change-table-data-title").text("変数の追加");$("#error-hensuu-name").addClass("d-none");$("#name").val("");$("#hname").text("int");$("#hid").text(n.length);$("#hensuu-list").append('<tr class="mdc-data-table__row" id="hensuu-'+n.length+'"><th class="mdc-data-table__cell name"><\/th><td class="mdc-data-table__cell hname"><\/td><td class="mdc-data-table__cell"><button class="mdc-button mdc-button--raised w-100 change-btn"><span class="mdc-button__label">変更<\/span><\/button><\/td><td class="mdc-data-table__cell"><button class="mdc-button mdc-button--outlined w-100 remove-btn"><span class="mdc-button__ripple"><\/span><span class="mdc-button__label">削除<\/span><\/button><\/td><\/tr>');document.querySelectorAll("#hensuu-list .mdc-button").forEach(function(n){console.log(n);new mdc.ripple.MDCRipple(n)});n.push(["",""]);i.open()});$(document).on("click",".change-btn",function(){$("#change-table-data-title").text("変数の変更");const t=$(this).parent().parent().attr("id").split("-")[1];$("#error-hensuu-name").addClass("d-none");$("#name").val(n[t][0]);$("#hname").text(n[t][1]);$("#hid").text(t);i.open()}).on("click",".remove-btn",function(){let t=$(this).parent().parent().attr("id").split("-")[1];for(n.splice(t,1);$("#hensuu-"+t).length;)$("#hensuu-"+t).attr("id","#hensuu-"+(t-1)),t++;$(this).parent().parent().remove();f()}).on("click",".random-case-remove-btn",function(){let n=$(this).parent().parent().attr("id").split("-")[1];for(t.splice(n,1);$("#random_case-"+n).length;)$("#random_case-"+n).attr("id","#random_case-"+(n-1)),n++;$(this).parent().parent().remove()}).on("click",".random-case-change-btn",function(){$("#random-case-dialog-title").text("ケースの変更");const i=$(this).parent().parent().attr("id").split("-")[1];$("#random-case-error").addClass("d-none");const u=$(".case_content");u.empty();n.forEach(function(n){$(".case_content").append('<label class="mdc-text-field mdc-text-field--outlined w-100 mt-3"><span class="mdc-notched-outline"><span class="mdc-notched-outline__leading"><\/span> <span class="mdc-notched-outline__notch"><span class="mdc-floating-label">変数'+n[0]+'<\/span><\/span> <span class="mdc-notched-outline__trailing"><\/span><\/span><input class="mdc-text-field__input text" required type="text"><\/label><div class="mdc-text-field-helper-line"><div class="mdc-text-field-helper-text">変数'+n[0]+"のケースを入れてください。型は"+n[1]+"です。<\/div><\/div>")});u.append('<label class="mdc-text-field mdc-text-field--outlined w-100 mt-3"><span class="mdc-notched-outline"><span class="mdc-notched-outline__leading"><\/span> <span class="mdc-notched-outline__notch"><span class="mdc-floating-label">対応する文字列<\/span><\/span> <span class="mdc-notched-outline__trailing"><\/span><\/span><input class="mdc-text-field__input text" required type="text"><\/label><div class="mdc-text-field-helper-line"><div class="mdc-text-field-helper-text">このケースに対応する文字列<\/div><\/div>');$(".text").each(function(n,r){$(r).val(t[i][n])});document.querySelectorAll(".case .mdc-text-field").forEach(function(n){new mdc.textField.MDCTextField(n)});$("#case_hid").text(i);r.open()}).on("change",".case-list-checkbox",function(){let n=$(this).parent().parent().parent().parent().attr("id").split("-")[1];t[n].pop();t[n].push($(this).prop("checked"))});$("#add_random_case").on("click",function(){$("#random-case-dialog-title").text("ケースの追加");$("#random-case-error").addClass("d-none");const i=$(".case_content");i.empty();n.forEach(function(n){$(".case_content").append('<label class="mdc-text-field mdc-text-field--outlined w-100 mt-3"><span class="mdc-notched-outline"><span class="mdc-notched-outline__leading"><\/span> <span class="mdc-notched-outline__notch"><span class="mdc-floating-label">変数'+n[0]+'<\/span><\/span> <span class="mdc-notched-outline__trailing"><\/span><\/span><input class="mdc-text-field__input text" required type="text"><\/label><div class="mdc-text-field-helper-line"><div class="mdc-text-field-helper-text">変数'+n[0]+"のケースを入れてください。型は"+n[1]+"です。<\/div><\/div>")});i.append('<label class="mdc-text-field mdc-text-field--outlined w-100 mt-3"><span class="mdc-notched-outline"><span class="mdc-notched-outline__leading"><\/span> <span class="mdc-notched-outline__notch"><span class="mdc-floating-label">対応する文字列<\/span><\/span> <span class="mdc-notched-outline__trailing"><\/span><\/span><input class="mdc-text-field__input text" required type="text"><\/label><div class="mdc-text-field-helper-line"><div class="mdc-text-field-helper-text">このケースに対応する文字列<\/div><\/div>');document.querySelectorAll(".case .mdc-text-field").forEach(function(n){new mdc.textField.MDCTextField(n)});$("#case_hid").text(t.length);r.open()});$("#random-case-save").on("click",function(){const i=$("#case_hid").text();let u=0;const f=$(".text");if(f.each(function(n,t){$(t).val()===""&&u++}),u!==0)$("#random-case-error").removeClass("d-none");else try{const u=[];f.each(function(t,i){if(n[t]!==undefined){if(n[t][1]==="int"||n[t][1]==="float"){if(isNaN(Number($(i).val()))){$("#random-case-error").removeClass("d-none");throw new TypeError("変換エラー！:int or float");}u.push(Number($(i).val()))}else if(n[t][1]==="list"||n[t][1]==="dict")try{u.push(JSON.parse($(i).val()))}catch(r){$("#random-case-error").removeClass("d-none");throw new TypeError("変換エラー！: list or dict");}}else u.push($(i).val())});const o=$("#random_case-"+i);o.length&&o.remove();let e='<tr class="mdc-data-table__row" id="random_case-'+i+'">';u.forEach(function(n){e+='<th class="mdc-data-table__cell">'+n+"<\/th>"});e+='<td class="mdc-data-table__cell"><div class="mdc-touch-target-wrapper"><div class="mdc-checkbox mdc-checkbox--touch"><input class="mdc-checkbox__native-control case-list-checkbox" type="checkbox"><div class="mdc-checkbox__background"><svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24"><path class="mdc-checkbox__checkmark-path" d="M1.73,12.91 8.1,19.28 22.79,4.59" fill="none" /><\/svg><div class="mdc-checkbox__mixedmark"><\/div><\/div><div class="mdc-checkbox__ripple"><\/div><\/div><\/div><td class="mdc-data-table__cell"><button class="mdc-button mdc-button--raised w-100 random-case-change-btn"><span class="mdc-button__label">変更<\/span><\/button><td class="mdc-data-table__cell"><button class="mdc-button mdc-button--outlined w-100 random-case-remove-btn"><span class="mdc-button__ripple"><\/span> <span class="mdc-button__label">削除<\/span><\/button>';u.push(!1);t.length>i?t.splice(i,1,u):t.push(u);console.log(t);i-1==-1&&$(e).prependTo("#random_case-list");$(e).insertAfter("#random_case-"+(i-1));document.querySelectorAll("#random_case-"+i+" .mdc-button").forEach(function(n){new mdc.ripple.MDCRipple(n)});document.querySelectorAll("#random_case-"+i+" .mdc-checkbox").forEach(function(n){new mdc.checkbox.MDCCheckbox(n)});r.close()}catch(e){console.warn("エラーを検知",e)}});$("#export-json").on("click",function(){const r=$("#title").val(),u=$("#point").val(),v=$("#tags").val(),f=$("#userid").val(),e=$("#restrict").val(),o=$("#problem").val(),c=$("#answer").val(),l=$("#com").val(),a=$("#test_case_generator").val(),i=[];if(r===""&&i.push("タイトル"),u===""&&i.push("得点"),f===""&&i.push("アカウントのID"),e===""&&i.push("満たすべき制約"),o.replace(/\r?\n/g,"")===""&&i.push("問題文"),c.replace(/\r?\n/g,"")===""&&i.push("想定解"),l.replace(/\r?\n/g,"")===""&&i.push("解説文"),a.replace(/\r?\n/g,"")===""&&i.push("テストケース生成コード"),i.length!==0)$("#error-msg").html(i.join("<br>")),s.open();else{const i={title:r,rating:Number(u),tags:v,user_id:f,restrict:e,question:o,test_case:{variables:{},cases:[],corner_cases:[]},expected_answer:c,test_case_generator:a,comment:l};n.forEach(function(n){i.test_case.variables[n[0]]=n[1]});t.forEach(function(t){var r={};n.forEach(function(n,i){r[n[0]]=t[i]});t.slice(-1)[0]?i.test_case.corner_cases.push({inputs:r,output:t.slice(-2)[0]}):i.test_case.cases.push({inputs:r,output:t.slice(-2)[0]})});console.log(i);$("#code").text(JSON.stringify(i,null,"  "));h.open()}});$("#save-json").on("click",function(){$("<a>",{href:"data:text/plain,"+encodeURIComponent($("#code").text()),download:$("#title").val()+".json"})[0].click()})})